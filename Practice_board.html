<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>2048练习板</title>

  <link href="style/main.css?v=46" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="favicon.ico?v=42">
  <link rel="apple-touch-icon" href="meta/apple-touch-icon.png?v=42">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' http://127.0.0.1:3001 http://localhost:3001; script-src 'self' https://www.google-analytics.com; style-src 'self' 'unsafe-inline';">
  
  <style>
      /* Test Board Specific Styles */
      .dashboard-container {
          display: flex;
          justify-content: space-between;
          margin-bottom: 20px;
          margin-top: 10px;
      }
      .dashboard-box {
          background: #bbada0; /* Box bg */
          padding: 10px;
          border-radius: 6px;
          color: white;
          box-sizing: border-box;
          min-height: 120px; /* Ensure height alignment */
      }
      .dashboard-stats {
          width: 25%;
      }
      .dashboard-controls {
          width: 68%;
          text-align: center;
          display: flex;
          width: 71%;
          text-align: center;
          /* Center content */
          display: flex;
          justify-content: center;
          align-items: center;
      }
      .dashboard-controls label {
          font-weight: bold;
          display: block;
          margin-bottom: 5px;
      }
      .dashboard-controls select {
          padding: 5px;
          border-radius: 3px;
          border: none;
          background: #faf8ef;
          color: #776e65;
          font-weight: bold;
      }
      .selection-grid {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 4px;
          margin-top: 5px;
          width: 100%;
      }
      .selection-tile {
          /* Simulate game tile but static */
          position: relative !important;
          width: 55px !important;
          height: 55px !important;
          border-radius: 3px;
          cursor: pointer;
          transition: transform 0.1s;
      }
      .selection-tile .tile-inner {
          width: 100% !important;
          height: 100% !important;
          line-height: 53px !important;
          font-size: 20px !important;
          border-radius: 3px;
      }
      /* Adjust fonts for larger numbers */
      .selection-tile.tile-128 .tile-inner,
      .selection-tile.tile-256 .tile-inner,
      .selection-tile.tile-512 .tile-inner { font-size: 18px !important; }
      
      .selection-tile.tile-1024 .tile-inner,
      .selection-tile.tile-2048 .tile-inner,
      .selection-tile.tile-4096 .tile-inner,
      .selection-tile.tile-8192 .tile-inner { font-size: 14px !important; }
      
      .selection-tile.tile-16384 .tile-inner,
      .selection-tile.tile-32768 .tile-inner { font-size: 12px !important; }

      .selection-tile:hover {
          transform: scale(1.1);
          z-index: 5;
      }
      .selection-tile.selected {
          transform: scale(1.15);
          box-shadow: 0 0 5px 2px rgba(255, 255, 0, 0.8); /* Highlight glow */
          z-index: 10;
          border: 2px solid #8f7a66; /* Border */
      }
      
      /* Special style for 0 */
      /* Special style for 0 */
      .selection-tile.tile-0 .tile-inner {
          background: rgba(238, 228, 218, 0.35);
          color: #776e65;
          text-align: center;
          line-height: 55px !important;
          font-weight: bold;
      }
      
      .grid-cell {
          cursor: pointer; /* Indicate clickable */
      }
      /* Hover effect for cleaner UI */
      .grid-cell:hover {
          background: rgba(238, 228, 218, 0.35);
      }
      .tile-container {
          pointer-events: none;
      }
      
      /* Guide Overlay */
      #guide-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          z-index: 2000;
          display: none;
      }
      #guide-message {
          position: absolute;
          color: white;
          font-weight: bold;
          font-size: 24px;
          z-index: 2002;
          pointer-events: none;
      }
      #guide-arrow {
          font-size: 40px;
          display: block;
          line-height: 1;
          margin-bottom: 5px;
      }
      .guide-highlight {
          position: relative;
          z-index: 2001;
          background: #faf8ef;
          box-shadow: 0 0 0 5px #faf8ef, 0 0 20px 10px rgba(255, 255, 255, 0.5);
          border-radius: 4px;
      }
  </style>
</head>
<body data-mode-id="practice_legacy">
  <div id="guide-overlay">
      <div id="guide-message">
          <span id="guide-arrow">↑</span>
          点击这里返回首页
      </div>
  </div>
  <a class="top-action-btn floating-settings-btn" id="top-settings-btn" title="设置">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
  </a>
  <div class="container">
    <!-- Dashboard Layout (Two Boxes at Top) -->
    <div class="dashboard-container">
        <!-- Box 1: Stats -->
        <div class="dashboard-box dashboard-stats">
            <div class="dashboard-stats-grid">
                <div id="stats-4-rate">4率: 10%</div>
                <div id="stats-total">总步数: 0</div>
                <div id="stats-moves">移动步数: 0</div>
                <div id="stats-undo">撤回步数: 0</div>
                <div id="stats-ips">IPS: 0</div>
            </div>
        </div>

        <!-- Box 2: Controls -->
        <div class="dashboard-box dashboard-controls">
            <div class="selection-grid" id="selection-grid">
                <!-- Row 1: 0-128 (8 items) -->
                <div class="selection-tile tile-0" data-value="0"><div class="tile-inner">0</div></div>
                <div class="selection-tile tile tile-2 selected" data-value="2"><div class="tile-inner">2</div></div>
                <div class="selection-tile tile tile-4" data-value="4"><div class="tile-inner">4</div></div>
                <div class="selection-tile tile tile-8" data-value="8"><div class="tile-inner">8</div></div>
                <div class="selection-tile tile tile-16" data-value="16"><div class="tile-inner">16</div></div>
                <div class="selection-tile tile tile-32" data-value="32"><div class="tile-inner">32</div></div>
                <div class="selection-tile tile tile-64" data-value="64"><div class="tile-inner">64</div></div>
                <div class="selection-tile tile tile-128" data-value="128"><div class="tile-inner">128</div></div>
                
                <!-- Row 2: 256-32k (8 items) -->
                <div class="selection-tile tile tile-256" data-value="256"><div class="tile-inner">256</div></div>
                <div class="selection-tile tile tile-512" data-value="512"><div class="tile-inner">512</div></div>
                <div class="selection-tile tile tile-1024" data-value="1024"><div class="tile-inner">1024</div></div>
                <div class="selection-tile tile tile-2048" data-value="2048"><div class="tile-inner">2048</div></div>
                <div class="selection-tile tile tile-4096" data-value="4096"><div class="tile-inner">4096</div></div>
                <div class="selection-tile tile tile-8192" data-value="8192"><div class="tile-inner">8192</div></div>
                <div class="selection-tile tile tile-16384" data-value="16384"><div class="tile-inner">16384</div></div>
                <div class="selection-tile tile tile-32768" data-value="32768"><div class="tile-inner">32768</div></div>
            </div>
        </div>
    </div>
    <div class="heading">
      <h1 class="title" style="float: left;"><a href="index.html" style="text-decoration: none; color: inherit; cursor: pointer;">2048</a>练习板</h1>
      <div class="scores-container" style="float: right;">
        <div class="score-container">0</div>
        <div class="best-container">0</div>
      </div>
      <div class="above-game" style="clear: both; padding-top: 15px;">

      <a class="restart-button" title="新游戏">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
      </a>
      </div>
    </div>

    <div id="timerbox">
        <div id="timer"></div>

        <div id="timer-row-16">
            <div class="timertile timer-legend-16" style="color: #f9f6f2; font-size: 22px;">16</div>
            <div class="timertile" id="timer16" style="margin-left:6px; width:159px"></div>
            <br><br>
        </div>
        <div id="timer-row-32">
            <div class="timertile timer-legend-32" style="color: #f9f6f2; font-size: 22px;">32</div>
            <div class="timertile" id="timer32" style="margin-left:6px; width:159px"></div>
            <br><br>
        </div>
        <div class="timertile timer-legend-64" style="color: #f9f6f2; font-size: 22px;">64</div>
        <div class="timertile" id="timer64" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-128" style="color: #f9f6f2; font-size: 18px;">128</div>
        <div class="timertile" id="timer128" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-256" style="color: #f9f6f2; font-size: 18px;">256</div>
        <div class="timertile" id="timer256" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-512" style="color: #f9f6f2; font-size: 18px;">512</div>
        <div class="timertile" id="timer512" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-1024" style="color: #f9f6f2; font-size: 14px;">1024</div>
        <div class="timertile" id="timer1024" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-2048" style="color: #f9f6f2; font-size: 14px;">2048</div>
        <div class="timertile" id="timer2048" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-4096" style="color: #f9f6f2; font-size: 14px;">4096</div>
        <div class="timertile" id="timer4096" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-8192" style="color: #f9f6f2; font-size: 14px;">8192</div>
        <div class="timertile" id="timer8192" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-16384" style="color: #f9f6f2; font-size: 13px;">16384</div>
        <div class="timertile" id="timer16384" style="margin-left:6px; width:159px"></div>
        <br><br>
        <div class="timertile timer-legend-32768" style="color: #f9f6f2; font-size: 13px;">32768</div>
        <div class="timertile" id="timer32768" style="margin-left:6px; width:159px"></div>
        <br><br>
        <!-- Sub-timers for 32k+ -->
        <div id="timer32k-sub-container" style="display:none;">
            <div class="timertile timer-legend-8192" style="color: #f9f6f2; font-size: 12px; margin-left: 25px; width: 40px;">8192</div>
            <div class="timertile" id="timer8192-sub" style="margin-left:6px; width:134px;"></div>
            <br><br>
            <div class="timertile timer-legend-16384" style="color: #f9f6f2; font-size: 12px; margin-left: 25px; width: 40px;">16384</div>
            <div class="timertile" id="timer16384-sub" style="margin-left:6px; width:134px;"></div>
        </div>
    </div>



    <div class="game-container">
      <div class="game-message">
        <p></p>
        <div class="lower">
	        <a class="keep-playing-button">继续游戏</a>
          <a class="undo-button" id="undo-btn-gameover">撤销</a>
          <a class="retry-button">重试</a>
        </div>
      </div>

      <div class="grid-container" id="test-grid-container">
        <!-- Rows will be clicked -->
        <div class="grid-row">
          <div class="grid-cell" data-x="0" data-y="0"></div>
          <div class="grid-cell" data-x="1" data-y="0"></div>
          <div class="grid-cell" data-x="2" data-y="0"></div>
          <div class="grid-cell" data-x="3" data-y="0"></div>
        </div>
        <div class="grid-row">
          <div class="grid-cell" data-x="0" data-y="1"></div>
          <div class="grid-cell" data-x="1" data-y="1"></div>
          <div class="grid-cell" data-x="2" data-y="1"></div>
          <div class="grid-cell" data-x="3" data-y="1"></div>
        </div>
        <div class="grid-row">
          <div class="grid-cell" data-x="0" data-y="2"></div>
          <div class="grid-cell" data-x="1" data-y="2"></div>
          <div class="grid-cell" data-x="2" data-y="2"></div>
          <div class="grid-cell" data-x="3" data-y="2"></div>
        </div>
        <div class="grid-row">
          <div class="grid-cell" data-x="0" data-y="3"></div>
          <div class="grid-cell" data-x="1" data-y="3"></div>
          <div class="grid-cell" data-x="2" data-y="3"></div>
          <div class="grid-cell" data-x="3" data-y="3"></div>
        </div>
      </div>

      <div class="tile-container">
      </div>
    </div>
    
    </div>


    
  </div>

  <div id="settings-modal" class="replay-modal-overlay" style="display: none;">
    <div class="replay-modal-content settings-modal-content">
      <h3>设置</h3>
      <div class="settings-row theme-settings-row">
        <div class="theme-selection-col">
          <label>棋子配色</label>
          <div class="custom-select-wrapper">
              <div class="custom-select">
                  <div class="custom-select-trigger" id="theme-select-trigger">
                      <span>选择主题</span>
                      <div class="custom-arrow"></div>
                  </div>
                  <div class="custom-select-options" id="theme-select-options">
                      <!-- Options populated by JS -->
                  </div>
              </div>
          </div>
          <!-- Hidden original select for fallback/data binding if needed -->
          <select id="theme-select" style="display:none"></select>
        </div>
        
        <div class="theme-preview-col">
          <label>配色预览</label>
          <div id="theme-preview-grid" class="theme-preview-grid"></div>
        </div>
      </div>
      <div class="settings-row">
        <label for="undo-enabled-toggle">撤回功能</label>
        <label class="settings-switch-row">
          <input id="undo-enabled-toggle" type="checkbox">
          <span>启用撤回（Z键/撤销按钮）</span>
        </label>
        <div id="undo-settings-note" class="settings-note"></div>
      </div>
      <div class="replay-modal-actions">
        <button id="settings-close-btn" class="replay-button">关闭</button>
      </div>
    </div>
  </div>

  <script src="js/seedrandom.js?v=42"></script>
  <script src="js/animframe_polyfill.js?v=42"></script>
  <script src="js/keyboard_input_manager.js?v=42"></script>
  <script src="js/theme_manager.js?v=4"></script>
  <script src="js/mode_catalog.js?v=3"></script>
  <script src="js/html_actuator.js?v=48"></script>
  <script src="js/grid.js?v=42"></script>
  <script src="js/tile.js?v=42"></script>
  <script src="js/local_score_manager.js?v=43"></script>
  <script src="js/api_client.js?v=4"></script>
  <script src="js/game_manager.js?v=59"></script>
  <script src="js/application.js?v=44"></script>
  <script src="js/index_ui.js?v=45"></script>
  
  <!-- Test UI Logic -->
  <script src="js/test_ui.js?v=42"></script>

</body>
</html>
